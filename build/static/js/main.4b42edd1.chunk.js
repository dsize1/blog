(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,t,n){e.exports=n(261)},135:function(e,t,n){},261:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(31),o=n.n(r),l=(n(135),n(42)),c=n(10),u=n(11),s=n(12),d=n(15),p=n(13),h=n(14),m=n(6),f=n(3),b=n(16),v=n(312),g=n(318),E=n(313),w=n(317),y=n(319),_="https://www.chengcici.info/api",O="https://www.chengcici.info/avatars",T=n(59),S=n.n(T),j=n(47),x=n.n(j),C=n(2),U=n(29),k=n(22),N=_,D=function(e){return{type:"FIRST_GET_REQUEST",payload:{lastFetch:e}}},F=function(e){return{type:"GET_REQUEST",payload:{direction:e}}},I=function(e){return{type:"GET_REQUEST_FAILURE",payload:{error:e}}},R=function(e){return{type:"GET_HOME_POSTS_SUCCESS",payload:e}},A=function(e,t,n,i,a){var r=e.data.filter(function(e){return!t.hasOwnProperty(e.id)}),o=e.data.map(function(e){return e.id}),l=n+o.length,c="bottom"===i?e.data[o.length-1].created_at:e.data[0].created_at;return[a({method:"bottom"===i?"push":"unshift",ids:o,data:r}),{type:"GET_TIMELINE_STATE",payload:{direction:i,unreadCount:l,lastFetch:c}}]},L=function(e){return{type:"UPDATE_REQUEST_FAILURE",payload:e}},P=function(e){return Object.values(e).every(function(e){var t=e.required,n=e.validate;return!t||n})},G=function(e){return Object.values(e).reduce(function(e,t){var n=t.type,i=t.name,a=t.value;return"draft"===n&&(a=a.toRAW()),e[i]=a,e},{})},H=function(e){return{type:"ADD_REQUEST_FAILURE",payload:e}},M=function(e){return{type:"ADD_TIMELINE_STATE",payload:e}},q=function(e,t){return t.forEach(function(t){return e(t)})},z=function(e){return{type:"AUTHENTICATION_FAILURE",payload:e}},Q=function(e,t,n){return e({type:"AUTHENTICATION"}),Object(U.a)("POST",t,n).then(function(t){e({type:"AUTHENTICATION_SUCCESS",payload:t.data}),e(V("authentication"))}).catch(function(t){var n=t.message;e(z({message:n,inputField:"authentication"})),e(V("authentication"))})},V=function(e,t){return{type:"INPUTFIELD_INIT",payload:{inputField:e,message:t}}},B=function(e,t){return{type:"INIT_LAST_FETCH",payload:{top:e,bottom:t}}},W=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:15;return function(a,r){var o,l=r().blog;if(t?o=l.homeTimeline.lastFetch[t]:(t="bottom",o=Date.now(),a(D(o))),!o)return null;var u=N+"/posts/".concat(e,"?d=").concat(t[0],"&l=").concat(o,"&w=").concat(n?"t":"f","&n=").concat(i),s=l.homeTimeline.unreadCount,d=l.entities.posts.fetchStatus;return a(F(t)),Object(U.a)("GET",u).then(function(i){n?q(a,A(i,d,s,t,function(e,t){return function(n){return{type:"GET_POSTS_WITH_ENTITY_SUCCESS",payload:Object(c.a)({},n,{user_id:e,entity:t})}}}(e,i.userinfo))):i.data.length&&q(a,A(i,d,s,t,function(e){return function(t){return{type:"GET_USER_POSTS_SUCCESS",payload:Object(c.a)({},t,{user_id:e})}}}(e)))}).catch(function(e){a(I(e))})}},J=function(e){return function(t,n){var i=n().blog,a=N+"/comments/".concat(e),r=i.homeTimeline.unreadCount,o=i.entities.comments.fetchStatus;return t(F("bottom")),Object(U.a)("GET",a).then(function(n){n.data.length&&q(t,A(n,o,r,"bottom",function(e){return function(t){return{type:"GET_COMMENTS_SUCCESS",payload:Object(c.a)({},t,{post_id:e})}}}(e)))}).catch(function(e){t(I(e))})}},X=function(){return function(e,t){var n=t(),i=n.blog,a=n.router,r=N+a.location.pathname;if(!P(i.authentication.fields))return e(z({message:"\u586b\u5199\u6709\u8bef",inputField:"authentication"}));var o,l=(o=i.authentication.fields,Object.values(o).reduce(function(e,t){var n=t.name,i=t.value;return e.append(n,i),e},new FormData));return Q(e,r,{body:l})}},Y=n(82);function Z(){var e=Object(f.a)(["\n  background-color: ",";\n  display: flow-root;\n  padding: .75rem .5rem;\n  border-radius: 1rem;\n\n    &::after {\n      content: '',\n      display: block;\n      height: 0;\n      visibility: hidden;\n      clear: both;\n    }\n\n    &>.submission {\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-end;\n      align-items: baseline;\n    }\n\n    &>.submission>span {\n      margin: 0 10px;\n      color: red;\n    }\n\n"]);return Z=function(){return e},e}var $=C.b.form(Z(),function(e){return e.theme.bgc}),K=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.children,i=t.fieldsName,r=t.inputField,o=t.btnTxt,l=t.handleSubmit,u=t.handleInputChange,s=t.handleFileChange,d=t.handleDraftChange,p=t.handleDraftBlur,h=r&&Object.values(r.fields).every(function(e){var t=e.validate;return!e.required||t}),m=h?"active":"disabled",f=!h&&r&&r.message;return a.a.createElement($,null,a.a.Children.map(n,function(t){var n=Object(c.a)({},t.props).name;if(null===r)return a.a.cloneElement(t,{name:n});var o,l,h=r.fields[n].validator;return"file"===r.fields[n].type?o=s.bind(e,i,n,h):"draft"===r.fields[n].type?(o=d.bind(e,i,n),l=p.bind(e,i,n,h)):o=u.bind(e,i,n,h),a.a.cloneElement(t,Object(c.a)({name:n,onChange:o,onBlur:l},r.fields[n]))}),a.a.createElement("div",{className:"submission"},a.a.createElement("span",null,f),a.a.createElement(Y.a,{className:m,onClick:l,text:o})))}}]),t}(i.Component),ee=Object(b.c)(null,function(e){return{handleFileChange:function(){return e(function(e,t,n,i){var a=n.pattern,r=n.message;return function(n,o){var l=i.target.files[0];if(l){var c=!1,u=a&&new RegExp(a);u&&u.test(l.type)&&(c=!0,r=""),n({type:"INPUTFIELD_CHANGE",inputField:e,field:t,data:{value:l,suffix:l.name,validate:c,error:r}})}}}.apply(void 0,arguments))},handleInputChange:function(){return e(function(e,t,n,i){var a=n.pattern,r=n.message;return function(n,o){var l=i.target.value,c=!1,u=a&&new RegExp(a);u&&u.test(l)&&(r="",c=!0),n({type:"INPUTFIELD_CHANGE",inputField:e,field:t,data:{value:l,error:r,validate:c}})}}.apply(void 0,arguments))},handleDraftChange:function(){return e(function(e,t,n){return function(i,a){i({type:"INPUTFIELD_CHANGE",inputField:e,field:t,data:{value:n}})}}.apply(void 0,arguments))},handleDraftBlur:function(){return e(function(e,t,n){n.pattern;var i=n.minLength,a=void 0===i?0:i,r=n.maxLength,o=void 0===r?1/0:r,l=n.maxLine,c=void 0===l?1/0:l,u=n.message;return function(n,i){var r=i().blog[e].fields[t].value.toRAW(!0).blocks,l=!1,s=r.reduce(function(e,t){return"unstyled"===t.type&&(e+=t.text),e},"").length,d=r.length;s>a&&s<=o&&d<=c&&(l=!0,u=""),n({type:"INPUTFIELD_CHANGE",inputField:e,field:t,data:{validate:l,error:u}})}}.apply(void 0,arguments))}}})(K),te=n(54);function ne(){var e=Object(f.a)(["\n  width: 100%;\n  background-color: transparent;\n  display: grid;\n  grid-template-columns: 1fr 5fr;\n\n    &>div:nth-of-type(1) {\n      text-align: right;\n      padding: 0 .5rem;\n    }\n    &>div:nth-of-type(1)>span {\n      color: red;\n    }\n\n    &>div:nth-of-type(2)>div:nth-of-type(1) {\n      display: flex;\n      flex-direction: row;\n      align-items: baseline;\n      max-height: 1.25rem;\n    }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>div {\n        text-align: center;\n        max-width: 15%;\n        padding: 0 .1rem;\n      }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>:nth-child(2) {\n        max-width: 75%;\n      }\n\n    &>div:nth-of-type(2)>div:nth-of-type(2),\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      min-height: 1.25rem;\n    }\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      color: red;\n    }\n"]);return ne=function(){return e},e}var ie=C.b.div(ne()),ae=function(e){var t=e.name,n=e.required,i=e.prefix,r=e.suffix,o=e.value,l=e.onChange,c=e.help,u=e.error,s=e.type,d=e.requiredVisible;return a.a.createElement(ie,null,a.a.createElement("div",null,a.a.createElement("span",null,d&&n&&"*"),t,":"),a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement("div",null,i),a.a.createElement(te.a,{name:t,type:s,value:o,onChange:l}),a.a.createElement("div",null,r)),a.a.createElement("div",null,c),a.a.createElement("div",null,u)))};function re(){var e=Object(f.a)(["\n  width: 100%;\n  background-color: transparent;\n  display: grid;\n  grid-template-columns: 1fr 5fr;\n\n    &>div:nth-of-type(1) {\n      text-align: right;\n      padding: 0 .5rem;\n      min-width: 20%;\n    }\n    &>div:nth-of-type(1)>span {\n      color: red;\n    }\n\n    &>div:nth-of-type(2)>div:nth-of-type(1) {\n      display: flex;\n      flex-direction: row;\n      align-items: flex-start;\n      max-height: 2.5rem;\n    }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>div {\n        text-align: center;\n        max-width: 25%;\n        min-height: 2.5rem;\n        max-height: 2.5rem;\n        padding: 0 2px;\n      }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>:nth-child(2) {\n        max-width: 50%;\n      }\n\n    &>div:nth-of-type(2)>div:nth-of-type(2),\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      min-height: 1.25rem;\n    }\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      color: red;\n    }\n"]);return re=function(){return e},e}var oe=C.b.div(re()),le=function(e){var t=e.name,n=e.required,i=e.prefix,r=e.suffix,o=e.onChange,l=e.help,c=e.error,u=e.type,s=e.value,d=e.requiredVisible;return a.a.createElement(oe,null,a.a.createElement("div",null,a.a.createElement("span",null,d&&n&&"*"),t,":"),a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement("div",null,i),a.a.createElement(te.a,{name:t,type:u,value:s,onChange:o}),a.a.createElement("div",null,a.a.createElement("img",{alt:"\u8bf7\u5237\u65b0",src:r}))),a.a.createElement("div",null,l),a.a.createElement("div",null,c)))},ce=Object(b.c)(function(e){return{inputField:e.blog.authentication,self_id:e.blog.user.id}},function(e){return{login:function(){return e(function(e,t){var n=t(),i=n.blog,a=n.router,r=N+a.location.pathname;if(!P(i.authentication.fields))return e(z({message:"\u586b\u5199\u6709\u8bef",inputField:"authentication"}));var o=G(i.authentication.fields),l={username:o.username,password:o.password,captcha:o.captcha};return Q(e,r,{body:JSON.stringify(l),headers:{"Content-Type":"application/json"}})})}}})(function(e){return e.self_id?a.a.createElement(w.a,{to:"/user/".concat(e.self_id)}):a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,{btnTxt:"\u767b\u5f55",fieldsName:"authentication",inputField:e.inputField,handleSubmit:e.login},a.a.createElement(ae,{requiredVisible:!0,name:"username"}),a.a.createElement(ae,{requiredVisible:!0,name:"password"}),a.a.createElement(le,{requiredVisible:!0,name:"captcha"})))});function ue(){var e=Object(f.a)(["\n    width: 100%;\n\n    &>label {\n      display: block;\n      box-sizing: border-box;\n      font-size: 1rem;\n      line-height: 1.25rem;\n      width: 100%;\n      max-height: 1.25rem;\n      border-radius: .5rem;\n      outline: none;\n      border: 1px solid ",";\n    }\n\n    &>input {\n      position: absolute;\n      clip: rect(0 0 0 0);\n      transform: scale(0);\n    }\n"]);return ue=function(){return e},e}var se=C.b.div(ue(),function(e){return e.theme.color}),de=function(e){return a.a.createElement(se,null,a.a.createElement("label",{htmlFor:e.name},"\u4e0a\u4f20",e.name),a.a.createElement("input",{type:e.type,id:e.name,name:e.name,accept:e.accept,onChange:e.onChange}))};function pe(){var e=Object(f.a)(["\n  width: 100%;\n  background-color: transparent;\n  display: grid;\n  grid-template-columns: 1fr 5fr;\n\n    &>div:nth-of-type(1) {\n      text-align: right;\n      padding: 0 .5rem;\n      min-width: 20%;\n    }\n    &>div:nth-of-type(1)>span {\n      color: red;\n    }\n\n    &>div:nth-of-type(2)>div:nth-of-type(1) {\n      display: flex;\n      flex-direction: row;\n      align-items: baseline;\n      max-height: 1.25rem;\n    }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>div {\n        text-align: center;\n        max-width: 25%;\n        padding: 0 2px;\n        line-height: 1.25rem;\n      }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>:nth-child(2) {\n        max-width: 50%;\n      }\n\n    &>div:nth-of-type(2)>div:nth-of-type(2),\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      min-height: 1.25rem;\n    }\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      color: red;\n    }\n"]);return pe=function(){return e},e}var he=C.b.div(pe()),me=function(e){var t=e.name,n=e.required,i=e.prefix,r=e.suffix,o=e.onChange,l=e.help,c=e.error,u=e.type,s=e.accept,d=e.requiredVisible;return a.a.createElement(he,null,a.a.createElement("div",null,a.a.createElement("span",null,d&&n&&"*"),t,":"),a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement("div",null,i),a.a.createElement(de,{name:t,type:u,accept:s,onChange:o}),a.a.createElement("div",null,r)),a.a.createElement("div",null,l),a.a.createElement("div",null,c)))},fe=Object(b.c)(function(e){return{inputField:e.blog.authentication,self_id:e.blog.user.id}},function(e){return{signup:function(t){return e(X())}}})(function(e){return e.self_id?a.a.createElement(w.a,{to:"/user/".concat(e.self_id)}):a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,{btnTxt:"\u6ce8\u518c",fieldsName:"authentication",inputField:e.inputField,handleSubmit:e.signup},a.a.createElement(ae,{requiredVisible:!0,name:"username"}),a.a.createElement(ae,{requiredVisible:!0,name:"password"}),a.a.createElement(me,{requiredVisible:!0,name:"avatar"}),a.a.createElement(le,{requiredVisible:!0,name:"captcha"})))});function be(){var e=Object(f.a)(["\n  padding: 0 10%;\n  min-height: 20rem;\n"]);return be=function(){return e},e}function ve(){var e=Object(f.a)(["\n  margin-top: 5rem;\n  background-color: ",";\n  border-radius: 1rem;\n\n    &>div:nth-of-type(1) {\n      padding: 0 10%;\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n    }\n\n    &>div:nth-of-type(1)>a {\n      flex-grow: 1;\n      text-align: center;\n      box-sizing: border-box;\n      border-radius: 1rem;\n      color: white;\n      background-color: ",";\n    }\n\n    &>div:nth-of-type(1)>a:hover {\n      text-decoration: underline;\n    }\n    &>div:nth-of-type(1).signup>a:nth-of-type(1),\n    &>div:nth-of-type(1).login>a:nth-of-type(2) {\n      background-color: #eee;\n      color: black;\n    }\n    &>div:nth-of-type(1).signup>a:nth-of-type(2),\n    &>div:nth-of-type(1).login>a:nth-of-type(1) {\n      pointer-events: none;\n    }\n"]);return ve=function(){return e},e}var ge=C.b.div(ve(),function(e){return e.theme.bgc},function(e){return e.theme.color}),Ee=C.b.div(be()),we=function(e){var t=e.match,n="/authentication"===e.location.pathname?"login":"signup";return a.a.createElement(ge,{url:t.url},a.a.createElement("div",{className:n},a.a.createElement(v.a,{to:"".concat(t.url)},"\u767b\u5f55"),a.a.createElement(v.a,{to:"".concat(t.url,"/signup")},"\u6ce8\u518c")),a.a.createElement(Ee,null,a.a.createElement(g.a,null,a.a.createElement(E.a,{path:"".concat(t.url,"/signup"),component:fe}),a.a.createElement(E.a,{exact:!0,path:"".concat(t.url),component:ce}))))};function ye(){var e=Object(f.a)(["\n  text-align: center;\n  margin-top: 200px;\n  font-size: 1.5rem;\n  &>a {\n    font-weight: bold;\n    color: ",";\n    text-decoration: underline; \n  }\n"]);return ye=function(){return e},e}var _e=C.b.div(ye(),function(e){return e.theme.color}),Oe=function(e){return a.a.createElement(_e,null,a.a.createElement("span",null,"\u8be5\u9875\u9762\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8bf7  "),a.a.createElement(v.a,{to:"/authentication"},"\u767b\u5f55/\u6ce8\u518c"),a.a.createElement("span",null,"  ... ..."))},Te=(n(85),n(86),n(18)),Se=n.n(Te),je=n(57),xe=n.n(je),Ce=n(125),Ue=n.n(Ce);function ke(){var e=Object(f.a)(["\n  width: 100%;\n  background-color: transparent;\n  display: grid;\n  grid-template-columns: 1fr 5fr;\n\n    &>div:nth-of-type(1) {\n      text-align: right;\n      padding: 0 .5rem;\n    }\n    &>div:nth-of-type(1)>span {\n      color: red;\n    }\n\n    &>div:nth-of-type(2)>div:nth-of-type(1) {\n      display: flex;\n      flex-direction: row;\n      align-items: baseline;\n    }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>div {\n        text-align: center;\n        padding: 0 .1rem;\n      }\n      &>div:nth-of-type(2)>div:nth-of-type(1)>:nth-child(2) {\n        width: 90%;\n        background-color: #fff;\n        border: 1px solid;\n        border-radius: .5rem;\n      }\n\n    &>div:nth-of-type(2)>div:nth-of-type(2),\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      min-height: 1.25rem;\n    }\n    &>div:nth-of-type(2)>div:nth-of-type(3) {\n      color: red;\n    }\n    &>div:nth-of-type(2)>div:nth-of-type(3):focus {\n      visibility: hidden;\n    }\n"]);return ke=function(){return e},e}Se.a.use(xe()()),Se.a.use(Ue()());var Ne=C.b.div(ke()),De=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.required,i=e.prefix,r=e.suffix,o=e.value,l=e.onChange,c=e.onBlur,u=e.help,s=e.error,d=e.controls,p=e.requiredVisible;return a.a.createElement(Ne,null,a.a.createElement("div",null,a.a.createElement("span",null,p&&n&&"*"),t,":"),a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement("div",null,i),a.a.createElement("div",{className:"draft-editor"},a.a.createElement(Se.a,{value:o,controls:d,onBlur:c,onChange:l,media:{validateFn:function(e){return e.size<51200},accepts:"image/png,image/jpeg,image/gif,image/webp,image/apng,image/svg"}})),a.a.createElement("div",null,r)),a.a.createElement("div",null,u),a.a.createElement("div",null,s)))}}]),t}(i.Component);function Fe(){var e=Object(f.a)(["\n  & div.draft-editor .bf-content {\n    min-height: 6rem;\n    height: fit-content;\n    overflow: visible;\n  }\n  & div.draft-editor pre.braft-code-block[class] {\n    max-height: fit-content;\n    overflow: visible;\n  }\n"]);return Fe=function(){return e},e}var Ie=C.b.div(Fe()),Re=function(e){return a.a.createElement(Ie,null,a.a.createElement(ee,{btnTxt:"\u53d1\u5e03",fieldsName:"postEditor",inputField:e.inputField,handleSubmit:e.handleSubmit},a.a.createElement(ae,{requiredVisible:!1,name:"title"}),a.a.createElement(De,{requiredVisible:!1,name:"content"})))};function Ae(){var e=Object(f.a)(["\n  position: relative;\n  &>a {\n    display: flex;\n    flex-direction: row;\n  }\n\n  &>a>.name {\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  &>a:hover>.name {\n    color: ",";\n    text-decoration: underline;\n  }\n\n  &>a>.id {\n    color: #666;\n  }\n\n  &>a>img {\n    width: 80px;\n    height: 80px;\n    position: absolute;\n    top: 0;\n    left: -90px;\n    background-color: transparent;\n    border-radius: 50%;\n  }\n"]);return Ae=function(){return e},e}var Le=C.b.div(Ae(),function(e){return e.theme.color}),Pe=function(e){return a.a.createElement(Le,null,a.a.createElement(v.a,{to:"/user/".concat(e.user_id)},a.a.createElement("p",{className:"name"},e.username),a.a.createElement("p",{className:"id"},"@",e.user_id.slice(-6)),a.a.createElement("img",{alt:"",src:"".concat(O,"/").concat(e.avatar)})))},Ge=function(e){var t=Math.floor((Date.now()-e)/1e3),n=t%60;if((t/=60)<1)return"".concat(Math.floor(n),"\u79d2");var i=t%60;if((t/=60)<1)return"".concat(Math.floor(i),"\u5206\u949f");var a=t%24;return(t/=24)<1?"".concat(Math.floor(a),"\u5c0f\u65f6"):t<30?"".concat(Math.floor(t),"\u5929"):t<365?"\u7ea6".concat(Math.floor(t/30),"\u4e2a\u6708"):"\u7ea6".concat(Math.floor(t/365),"\u5e74")};function He(){var e=Object(f.a)(["\n  display: flex;\n  flex-direction: row-reverse;\n\n    &>* {\n      margin: 0 .5rem;\n    }\n"]);return He=function(){return e},e}var Me=C.b.div(He()),qe=function(e){return a.a.createElement(Me,null,a.a.createElement("span",null,"\u53d1\u5e03\u65e5\u671f\uff1a".concat(new Date(e.created_at).toLocaleString().slice(0,-3))),a.a.createElement("span",null,e.created_at!==e.updated_at&&"\u66f4\u65b0\u4e8e\uff1a".concat(Ge(e.updated_at),"\u524d")))};function ze(){var e=Object(f.a)(["\n  position: relative;\n  padding: .75rem .75rem 14px 0;\n  padding-left: 5rem;\n  border-bottom: 1px solid #ccc;\n  &:hover {\n    background-color: #eee;\n  }\n\n    &>div:nth-of-type(2)>P{\n      font-size: 1.5rem;\n      line-height: 2.5rem;\n      font-weight: bold;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      overflow: hidden;\n    }\n    &>div:nth-of-type(2)>a {\n      min-height: 6rem;\n      max-height: 6rem;\n      display: flex;\n      flex-wrap: nowrap;\n    }\n    &>div:nth-of-type(2)>a>img {\n      width: 9.5rem;\n      height: 6rem;\n      object-fit: cover;\n      margin-right: 1rem;\n    }\n    &>div:nth-of-type(2)>a>p {\n      flex-grow: 1;\n      word-break: break-all;\n      overflow: hidden;\n    }\n"]);return ze=function(){return e},e}var Qe=C.b.div(ze()),Ve=function(e){var t=Se.a.createEditorState(e.content).toRAW(!0),n=t.blocks,i=t.entityMap,r=n.reduce(function(e,t){return"unstyled"===t.type&&(e+=t.text),e},""),o=Object.values(i),l=o.length>0&&o[0].data.url,c=l&&a.a.createElement("img",{src:l,alt:""}),u=l?100:150;return r=r.length>u?r.slice(0,u)+"...":r,a.a.createElement(Qe,null,a.a.createElement(Pe,{avatar:e.avatar,user_id:e.user_id,username:e.author}),a.a.createElement("div",null,a.a.createElement("p",null,e.title),a.a.createElement(v.a,{to:"/post/".concat(e.post_id)},c,a.a.createElement("p",null,r))),a.a.createElement(qe,{created_at:e.created_at,updated_at:e.updated_at}))};function Be(){var e=Object(f.a)(["\n  height: 2.5rem;\n  position: relative;\n  background-color: transparent;\n  border-bottom: 1px solid #ccc;\n    &>div{\n      background-color: transparent;\n      width: 1px;\n      height: 1px;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      animation: "," 5s steps(10) infinite;\n    }\n      &>div>i {\n        border-radius: 50%;\n        display: block;\n        width: .5rem;\n        height: 1rem;\n        position: absolute;\n        top: 0;\n        left: 0;\n        transform-origin: 0 0;\n      }\n      &>div>i:nth-of-type(1) {\n        background-color: #4169e144;\n      }\n      &>div>i:nth-of-type(2) {\n        background-color: #4169e177;\n        transform: \n          rotate(72deg)\n      }\n      &>div>i:nth-of-type(3) {\n        background-color: #4169e1aa;\n        transform: \n          rotate(144deg)\n      }\n      &>div>i:nth-of-type(4) {\n        background-color: #4169e1cc;\n        transform: \n          rotate(216deg)\n      }\n      &>div>i:nth-of-type(5) {\n        background-color: #4169e1ff;\n        transform: \n          rotate(288deg)\n      }\n"]);return Be=function(){return e},e}function We(){var e=Object(f.a)(["\n  from {\n    transform: rotate(0)\n  }\n  to {\n    transform: rotate(360deg)\n  }\n"]);return We=function(){return e},e}var Je=Object(C.c)(We()),Xe=C.b.div(Be(),Je),Ye=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.visible!==this.props.visible}},{key:"render",value:function(){return this.props.visible?a.a.createElement(Xe,null,a.a.createElement("div",null,a.a.createElement("i",null),a.a.createElement("i",null),a.a.createElement("i",null),a.a.createElement("i",null),a.a.createElement("i",null))):null}}]),t}(i.Component),Ze=function(e){return function(t){function n(e){var t;return Object(u.a)(this,n),(t=Object(d.a)(this,Object(p.a)(n).call(this,e))).state={start:0,end:Math.ceil(document.documentElement.clientHeight/t.props.itemHeight)+5,screenHeight:document.documentElement.clientHeight},t._handleScroll=x()(t._handleScroll.bind(Object(m.a)(Object(m.a)(t))),167),t._handleResize=t._handleResize.bind(Object(m.a)(Object(m.a)(t))),t._handleGetRequest=x()(t.props.handleGetRequest,5e3,{leading:!0}),t}return Object(h.a)(n,t),Object(s.a)(n,[{key:"_handleScroll",value:function(){var e=this,t=document.documentElement.scrollTop;this.setState(function(n){var i=Math.floor(t/e.props.itemHeight)-5,a=i+Math.ceil(n.screenHeight/e.props.itemHeight)+10;return i<0&&(i=0),a>e.props.timeline.length&&(!e.props.loading&&e._handleGetRequest("bottom"),a=e.props.timeline.length),{start:i,end:a}})}},{key:"_handleResize",value:function(){this.setState({screenHeight:document.documentElement.clientHeight}),this._handleScroll()}},{key:"componentDidMount",value:function(){document.addEventListener("scroll",this._handleScroll),window.addEventListener("resize",this._handleResize)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("scroll",this._handleScroll),window.removeEventListener("resize",this._handleResize)}},{key:"render",value:function(){var t=this.props,n=t.timeline,i=t.itemHeight,r=t.isLoadingDirection,o=t.loading,l=t.posts,c="top"===r&&o,u="bottom"===r&&o,s=u?"2.5":"0",d=c?"2.5":"0",p=n.slice(this.state.start,this.state.end),h=this.state.start*i,m=(n.length-this.state.end)*i;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ye,{visible:c}),a.a.createElement("div",{style:{height:"calc(".concat(h,"px - ").concat(s,"rem)")}}),a.a.createElement(e,{timeline:p,posts:l}),a.a.createElement("div",{style:{height:"calc(".concat(m,"px - ").concat(d,"rem)")}}),a.a.createElement(Ye,{visible:u}))}}]),n}(i.Component)}(function(e){var t=e.timeline.map(function(t,n){if(!e.posts.entities[t])return null;var i=e.posts.entities[t],r=i.author,o=i.user_id,l=i.avatar,c=i.title,u=i.content,s=i.created_at,d=i.updated_at;return a.a.createElement("li",{key:t,className:"post-".concat(t)},a.a.createElement(Ve,{avatar:l,post_id:t,author:r,user_id:o,title:c,content:u,created_at:s,updated_at:d}))});return a.a.createElement("ul",null,t)}),$e=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).user_id=n.props.match.params.user_id,n.self_id=n.props.self_id,n._handleGetRequest=n.props.handleGetUserPosts.bind(Object(m.a)(Object(m.a)(n)),n.user_id),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.user_id===this.self_id&&0===this.props.usersEntities[this.user_id].timeline.length)this._handleGetRequest();else if(this.props.usersEntities.hasOwnProperty(this.user_id)){var e=this.props.usersEntities[this.user_id].timeline,t=e[0],n=e[e.length-1],i=this.props.posts;this.props.initLastFetch(i.entities[t].created_at,i.entities[n].created_at)}else this._handleGetRequest(null,!0)}},{key:"shouldComponentUpdate",value:function(e,t){return!!e.usersEntities.hasOwnProperty(this.user_id)}},{key:"render",value:function(){var e=this.props,t=e.homeTimeline,n=e.inputField,i=e.handleAddPost,r=e.usersEntities,o=e.posts,l=t.loading,c=t.isLoadingDirection,u=r[this.user_id]&&r[this.user_id].timeline;return u?a.a.createElement("div",{className:"blog"},this.user_id===this.self_id&&a.a.createElement(Re,{inputField:n,handleSubmit:i}),a.a.createElement(Ze,{isLoadingDirection:c,loading:l,itemHeight:250,handleGetRequest:this._handleGetRequest,timeline:u,posts:o})):a.a.createElement(a.a.Fragment,null,a.a.createElement(Ye,null))}}]),t}(i.Component),Ke=Object(b.c)(function(e){return{self_id:e.blog.user.id,usersEntities:e.blog.entities.users.entities,posts:e.blog.entities.posts,inputField:e.blog.postEditor,homeTimeline:e.blog.homeTimeline}},function(e){return{handleGetUserPosts:function(){return e(W.apply(void 0,arguments))},handleAddPost:function(){return e(function(e,t){var n=t().blog,i=n.user,a=i.id,r=i.username,o=i.avatar,l=N+"/posts/".concat(a);if(!P(n.postEditor.fields))return e(H({message:"\u586b\u5199\u6709\u8bef",inputField:"postEditor"}));var u=Date.now(),s=Object(c.a)({user_id:a,author:r,avatar:o,created_at:u,updated_at:u},G(n.postEditor.fields));return e({type:"ADD_REQUEST"}),Object(U.a)("POST",l,{body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(function(t){var n=t.data.id,i=Object(c.a)({},s,{id:n});e({type:"ADD_POST_SUCCESS",payload:{user_id:a,id:n,entity:i}}),e(M({lastFetch:u,direction:"top"})),e(V("postEditor",!0))}).catch(function(t){var n=t.message;e(H({message:n,inputField:"postEditor"})),e(V("postEditor"))})})},initLastFetch:function(){return e(B.apply(void 0,arguments))}}})($e);Se.a.use(xe()());var et=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(Se.a,{readOnly:!0,value:Se.a.createEditorState(e.content)}))};function tt(){var e=Object(f.a)(["\n  position: relative;\n  background-image: ",";\n  width: 1.25rem;\n  height: 1.25rem;\n  display: ",";\n  &::before {\n    content: '>';\n    display: block;\n    transform: rotate(90deg);\n    color: #999;\n    text-align: center;\n    line-height: 1.25rem;\n  }\n  &:hover::before {\n    color: ",";\n  }\n  &>ul {\n    visibility: hidden;\n    opacity: 0;\n    pointer-events: none;\n    cursor: grab;\n    position: absolute; \n    top: 100%;\n    right: 0;\n    background-color: #fff;\n    border-radius: 4px;\n    padding: 10px 0;\n    z-index: 0;\n    box-shadow: 0 1px 4px rgba(0,0,0,0.25);\n    transition: \n      visibility .5s ease-in-out 1s,\n      opacity .5s ease-in-out 1s;\n  }\n  &:hover>ul,\n  &>ul:hover {\n    visibility: visible;\n    opacity: 1;\n    z-index: 900;\n    pointer-events: all;\n    transition: \n      visibility .5s ease-in-out,\n      opacity .5s ease-in-out;\n  }\n  &>ul>li {\n    white-space: nowrap;\n    padding: .2rem;\n  }\n  &>ul>li:hover {\n    background-color: #ccc;\n  }\n  &>ul>li:disabled {\n    text-decoration: overline;\n    color: orange;\n  }\n"]);return tt=function(){return e},e}var nt=C.b.label(tt(),function(e){return e.bgi},function(e){return e.display},function(e){return e.theme.color}),it=function(e){return a.a.createElement(nt,{bgi:e.bgi,display:e.display},a.a.createElement("ul",null,e.children))};function at(){var e=Object(f.a)(["\n  padding: 0.6rem .75rem;\n  position: relative;\n  padding-left: 5rem;\n  border-bottom: 1px solid #ccc;\n  &:hover {\n    background-color: #eee;\n  }\n\n    &>div:nth-of-type(1) {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: .25rem;\n    }\n\n    &>p {\n      min-height: 6rem;\n      max-height: 6rem;\n      word-wrap: break-word;\n      overflow: hidden;\n    }  \n"]);return at=function(){return e},e}var rt=C.b.div(at()),ot=function(e){var t=e.user_id===e.self_id?"flow-root":"none";return a.a.createElement(rt,null,a.a.createElement("div",null,a.a.createElement(Pe,{avatar:e.avatar,user_id:e.user_id,username:e.author}),a.a.createElement(it,{display:t},a.a.createElement("li",{onClick:e.handleStartUp},"\u7f16\u8f91"),a.a.createElement("li",{onClick:e.handleDelComment},"\u5220\u9664"))),a.a.createElement("p",{className:"content",dangerouslySetInnerHTML:{__html:Se.a.createEditorState(e.content).toHTML()}}),a.a.createElement(qe,{created_at:e.created_at,updated_at:e.updated_at}))},lt=n(28),ct=function(e,t){return Object.entries(e).reduce(function(e,n){var i=Object(lt.a)(n,2),a=i[0],r=i[1];return t.hasOwnProperty(a)||(e[a]=r),e},{})};function ut(){var e=Object(f.a)(["\n    width: 100%;\n    margin: 0 auto; \n    position: relative;  \n\n      &>div {\n        position: relative;\n        margin: 5px auto;\n        display: flex;\n        flex-direction: row;\n        justify-content: center;\n      }\n\n        &>div>div {\n          min-width: 282px;\n        }\n\n        &>div button {\n          border: none;\n        }\n\n        &>div label {\n          border: 1px solid;\n          border-radius: 5px;\n        }\n\n        &>div button,\n        &>div>div>* {\n          background-color: transparent;\n          cursor: grab;\n          height: 25px;\n          text-align: center;\n        }\n\n        &>div label."," {\n          background-color: ",";\n          font-weight: bolder;\n          border: 1px solid ",";\n          color: #fff;\n        }\n\n        &>div>div>*{\n          width: 25px;\n          display: inline-block;\n          margin: 0 10px;\n        }\n        \n          &>div input {\n            position: absolute;\n            left: -200px;\n            visibility: hidden;\n            height: 0;\n            width: 0;\n            pointer-events: none;\n          }\n\n      &>ul {\n        display: flex;\n        width: ","px;\n        margin: 0 auto;\n        flex-direction: column;\n        overflow: hidden;\n      }\n\n        &>ul>li {\n          width: ","px;\n        }\n  "]);return ut=function(){return e},e}var st=function(e){var t=C.b.div(ut(),function(e){return"page-"+e.current},function(e){return e.theme.color},function(e){return e.theme.color},function(e){var t=e.width;return Math.floor(t)},function(e){var t=e.width;return Math.floor(t)});return function(n){function i(e){var t;return Object(u.a)(this,i),(t=Object(d.a)(this,Object(p.a)(i).call(this,e))).randomName="radio-"+Date.now().toString(16).padEnd(20,"#").split("").map(function(e){return"#"!==e?e:(Math.floor(100*Math.random())%16).toString(16)}).join(""),t.state={current:t.props.defaultCurrent||1,hideOnSinglePage:t.props.hideOnSinglePage||!1,pageSize:t.props.defaultPageSize||10,pageSizeOptions:t.props.pageSizeOptions||["10","20","30","40"],showQuickJumper:t.props.showQuickJumper||!1},t._handleChange=t._handleChange.bind(Object(m.a)(Object(m.a)(t))),t}return Object(h.a)(i,n),Object(s.a)(i,[{key:"_handleChange",value:function(e){var t=e.target,n="radio"===t.type?Number.parseInt(t.value):this.state.current+Number.parseInt(t.attributes["data-changed"].value);this.setState({current:n})}},{key:"render",value:function(){var n=this,i=ct(this.props,this.state),r=new Array(Math.ceil(this.props.total/this.state.pageSize)).fill(0).map(function(e,t,i){var r=i.length;return r<=5||0===t||t===r-1||t>=n.state.current-3&&t<=n.state.current+1?a.a.createElement("label",{key:t,className:"page-".concat(t+1)},a.a.createElement("input",{type:"radio",value:t+1,checked:t===n.state.current-1,name:"".concat(n.randomName),onChange:n._handleChange}),t+1):t===n.state.current-4||t===n.state.current+2?a.a.createElement("span",{key:t},"..."):null});return a.a.createElement(t,{ref:function(e){return n.wrapper=e},className:"paginationController",current:this.state.current,pageSize:this.state.pageSize,width:this.wrapper&&this.wrapper.offsetWidth},a.a.createElement(e,Object.assign({current:this.state.current,pageSize:this.state.pageSize},i)),a.a.createElement("div",null,a.a.createElement("button",{"data-changed":"-1",disabled:1===this.state.current,onClick:this._handleChange},"\u4e0a\u4e00\u9875"),a.a.createElement("div",null,r),a.a.createElement("button",{"data-changed":"1",disabled:this.state.current===Math.ceil(this.props.total/this.state.pageSize),onClick:this._handleChange},"\u4e0b\u4e00\u9875")))}}]),i}(i.Component)}(function(e){return a.a.createElement("ul",null,e.timeline.map(function(t,n){if(!e.comments.entities[t]||Math.floor(n/e.pageSize)!==e.current-1)return null;var i=e.comments.entities[t],r=i.user_id,o=i.author,l=i.avatar,c=i.content,u=i.created_at,s=i.updated_at,d=e.handleDelComment.bind(null,t),p=e.handleStartUp.bind(null,{content:c},t,{user_id:r,author:o,avatar:l,created_at:u});return a.a.createElement("li",{key:t,className:"comment-".concat(n)},a.a.createElement(ot,{id:t,avatar:l,user_id:r,self_id:e.self_id,author:o,content:c,created_at:u,updated_at:s,handleDelComment:d,handleStartUp:p}))}))}),dt=n(77);function pt(){var e=Object(f.a)(["\n\n  & div.draft-editor .bf-content {\n    min-height: 4rem;\n    height: fit-content;\n    overflow: visible;\n  }\n"]);return pt=function(){return e},e}var ht=C.b.div(pt()),mt=function(e){return a.a.createElement(ht,null,a.a.createElement(ee,{btnTxt:"\u53d1\u5e03",fieldsName:"commentEditor",inputField:e.inputField,handleSubmit:e.handleSubmit},a.a.createElement(De,{requiredVisible:!1,name:"content"})))};function ft(){var e=Object(f.a)(["\n    &>.post-container {\n      padding: 1rem .75rem;\n    }\n      &>.post-container>div:nth-of-type(1) {\n        display: flex;\n        justify-content: space-between;\n        flex-direction: row;\n      }\n\n      &>.post-container>div:nth-of-type(1)>h2 {\n        word-wrap: break-word;\n        font-weight: bold;\n      }\n\n      &>.post-container>.user {\n        margin: 1rem 5rem;\n        min-height: 5rem;\n        max-height: 5rem;\n      }\n\n      &>.post-container .bf-controlbar {\n        display: none;\n        pointer-events: none;\n        height: 0;\n        opacity: 0;\n      }\n\n      &>.post-container .bf-content {\n        min-height: 6rem;\n        height: fit-content;\n        overflow: visible;\n      }\n      &>.post-container pre.braft-code-block[class] {\n        max-height: fit-content;\n        overflow: visible;\n      }\n"]);return ft=function(){return e},e}var bt=C.b.div(ft()),vt=function(e){function t(e){var n;Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={currentUpdateEditor:"",handleUpdate:null};var i=n.props.initInputField,a=n.props.transmitValues;n.commentEditorLayer=null,n.setCommentEditorLayerRef=function(e){return n.commentEditorLayer=e},n.post_id=n.props.match.params.post_id,n._handleAddComment=n.props.handleAddComment.bind(null,n.post_id),n._handleDelComment=n.props.handleDelComment.bind(null,n.post_id),n._handleCloseCommentEditor=n._handleShutDown.bind(Object(m.a)(Object(m.a)(n)),i,"commentEditor");var r=n.props.handleUpdateComment.bind(Object(m.a)(Object(m.a)(n)),n._handleCloseCommentEditor,n.post_id);n._handleOpenCommentEditor=n._handleStartUp.bind(Object(m.a)(Object(m.a)(n)),a,"commentEditor",r),n.postEditorLayer=null,n.setPostEditorLayerRef=function(e){return n.postEditorLayer=e},n._handleClosePostEditor=n._handleShutDown.bind(Object(m.a)(Object(m.a)(n)),i,"postEditor");var o=n.props.handleUpdatePost.bind(Object(m.a)(Object(m.a)(n)),n._handleClosePostEditor,n.props.self_id);return n._handleOpenPostEditor=n._handleStartUp.bind(Object(m.a)(Object(m.a)(n)),a,"postEditor",o),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_handleShutDown",value:function(e,t,n){n&&n.target!==this.commentEditorLayer&&n.target!==this.postEditorLayer||(e(t,!0),this.setState({currentUpdateEditor:"",handleUpdate:null}))}},{key:"_handleStartUp",value:function(e,t,n,i,a,r){e(t,i),this.setState({currentUpdateEditor:t,handleUpdate:n.bind(this,a,r)})}},{key:"componentDidMount",value:function(){this.props.postsEntities[this.post_id]&&0!==this.props.postsEntities[this.post_id].timeline.length||this.props.handleGetRequest(this.post_id)}},{key:"render",value:function(){var e=this,t=this.props.postsEntities[this.post_id],n=t.title,i=t.content,r=t.avatar,o=t.author,l=t.user_id,c=t.created_at,u=t.updated_at,s=t.timeline,d=this._handleOpenPostEditor.bind(null,{title:n,content:i},this.post_id,{user_id:l,author:o,avatar:r,created_at:c}),p=l===this.props.self_id?"flow-root":"none",h="commentEditor"===this.state.currentUpdateEditor?this.props.commentEditor:null,m="postEditor"===this.state.currentUpdateEditor?this.props.postEditor:null,f=""===this.state.currentUpdateEditor?this.props.commentEditor:null;return a.a.createElement(a.a.Fragment,null,a.a.createElement(bt,null,a.a.createElement("div",{className:"post-container"},a.a.createElement("div",null,a.a.createElement("h2",null,n),a.a.createElement(it,{display:p},a.a.createElement("li",{onClick:d},"\u7f16\u8f91"))),a.a.createElement("div",{className:"user"},a.a.createElement(Pe,{avatar:r,user_id:l,username:o})),a.a.createElement(et,{content:i}),a.a.createElement("div",{className:"timeStamp"},a.a.createElement(qe,{created_at:c,updated_at:u}))),a.a.createElement(mt,{inputField:f,handleSubmit:this._handleAddComment}),a.a.createElement(st,{total:s.length,self_id:this.props.self_id,timeline:s,comments:this.props.comments,handleStartUp:this._handleOpenCommentEditor,handleDelComment:this._handleDelComment})),a.a.createElement(dt.a,{outerlayer:this.setCommentEditorLayerRef,alive:"commentEditor"===this.state.currentUpdateEditor,handleShutDown:this._handleCloseCommentEditor,inputField:h,handleSubmit:this.state.handleUpdate,render:function(t){return"commentEditor"===e.state.currentUpdateEditor&&a.a.createElement(mt,t)}}),a.a.createElement(dt.a,{outerlayer:this.setPostEditorLayerRef,alive:"postEditor"===this.state.currentUpdateEditor,handleShutDown:this._handleClosePostEditor,inputField:m,handleSubmit:this.state.handleUpdate,render:function(t){return"postEditor"===e.state.currentUpdateEditor&&a.a.createElement(Re,t)}}))}}]),t}(i.Component),gt=Object(b.c)(function(e){return{postsEntities:e.blog.entities.posts.entities,comments:e.blog.entities.comments,commentEditor:e.blog.commentEditor,postEditor:e.blog.postEditor,self_id:e.blog.user.id}},function(e){return{handleGetRequest:function(){return e(J.apply(void 0,arguments))},handleUpdateComment:function(){return e(function(e,t,n,i){return function(a,r){var o=r().blog,l=N+"/comments/".concat(t),u=Date.now();if(!P(o.commentEditor.fields))return a(H({message:"\u586b\u5199\u6709\u8bef",inputField:"commentEditor"}));var s=Object(c.a)({id:n,post_id:t,updated_at:u},i,G(o.commentEditor.fields));return a({type:"UPDATE_REQUEST"}),Object(U.a)("PUT",l,{body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(function(t){a({type:"UPDATE_COMMENT_REQUEST_SUCCESS",payload:{id:n,entity:s}}),e()}).catch(function(e){var t=e.message;a(L({message:t,inputField:"commentEditor"})),a(V("commentEditor"))})}}.apply(void 0,arguments))},handleUpdatePost:function(){return e(function(e,t,n,i){return function(a,r){var o=r().blog,l=N+"/posts/".concat(t),u=Date.now();if(!P(o.postEditor.fields))return a(H({message:"\u586b\u5199\u6709\u8bef",inputField:"postEditor"}));var s=Object(c.a)({id:n,updated_at:u},i,G(o.postEditor.fields));return a({type:"UPDATE_REQUEST"}),Object(U.a)("PUT",l,{body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(function(t){a({type:"UPDATE_POST_REQUEST_SUCCESS",payload:{id:n,entity:s}}),e()}).catch(function(e){var t=e.message;a(L({message:t,inputField:"postEditor"})),a(V("postEditor"))})}}.apply(void 0,arguments))},handleAddComment:function(){return e(function(e){return function(t,n){var i=n().blog,a=N+"/comments/".concat(e),r=i.user,o=r.id,l=r.username,u=r.avatar;if(!P(i.commentEditor.fields))return t(H({message:"\u586b\u5199\u6709\u8bef",inputField:"commentEditor"}));var s=Date.now(),d=Object(c.a)({user_id:o,post_id:e,author:l,avatar:u,created_at:s,updated_at:s},G(i.commentEditor.fields));return t({type:"ADD_REQUEST"}),Object(U.a)("POST",a,{body:JSON.stringify(d),headers:{"Content-Type":"application/json"}}).then(function(n){var i=n.data.id,a=Object(c.a)({},d,{id:i});t({type:"ADD_COMMENT_SUCCESS",payload:{post_id:e,id:i,entity:a}}),t(M({lastFetch:s,direction:"bottom"})),t(V("commentEditor",!0))}).catch(function(e){var n=e.message;t(H({message:n,inputField:"commentEditor"})),t(V("commentEditor"))})}}.apply(void 0,arguments))},handleDelComment:function(){return e(function(e,t){return function(n,i){var a=i(),r=a.blog,o=a.router,l=r.user.id,c=N+"/comments/".concat(e),u={user_id:l,id:t};return n({type:"DELETE_REQUEST"}),Object(U.a)("DELETE",c,{body:JSON.stringify(u),headers:{"Content-Type":"application/json"}}).then(function(i){n({type:"DELETE_REQUEST_SUCCESS",payload:{post_id:e,id:t}}),n(Object(k.d)(o.location.pathname))}).catch(function(e){var t=e.message;n({type:"DELETE_REQUEST_FAILURE",payload:{message:t}}),n(Object(k.d)("/home"))})}}.apply(void 0,arguments))},initInputField:function(){return e(V.apply(void 0,arguments))},transmitValues:function(){return e(function(e,t){return{type:"TRANSMIT_VALUES",payload:{inputField:e,entries:t}}}.apply(void 0,arguments))}}})(vt);function Et(){var e=Object(f.a)(["\n  width: 100%;\n  height: 1.25rem;\n  line-height: 1.25rem\n  text-align: center;\n  background-color: ",";\n  &>div {\n    margin: 0 auto;\n    color: ",";\n  }\n  &>div:hover {\n    text-decoration: underline;\n    cursor: grab;\n  }\n"]);return Et=function(){return e},e}var wt=C.b.div(Et(),function(e){return e.theme.bgc},function(e){return e.theme.color}),yt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e)))._fetchPublishCount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"&t=45000",t=new XMLHttpRequest,i=n.props.homeTimeline.lastFetch.top||Date.now(),a=n.baseUrl+"/comet?l=".concat(i,"&n=20")+e;t.open("GET",a),t.timeout=6e4,t.send(null),t.onload=n._onload,t.onerror=n._fetchAbort,t.ontimeout=n._fetchAbort,n.setState({xhr:t})},n._onload=function(){n.setState(function(e){var t=e.publishCount;return n.state.xhr.status<400&&(t=JSON.parse(e.xhr.responseText).data.publishCount),{xhr:null,publishCount:t}})},n._fetchAbort=function(){n.setState(function(e){return e.xhr&&0!==e.xhr.readyState&&e.xhr.abort(),{xhr:null}})},n._initPublishCount=function(){n.setState({publishCount:0})},n._cometSwitch=function(e){n.setState({turnon:e})},n.state={publishCount:0,xhr:null,turnon:!0},n.baseUrl=_,n._handleGetNewPublish=n._handleGetNewPublish.bind(Object(m.a)(Object(m.a)(n)),n.props.handleGetNewPublish),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_handleGetNewPublish",value:function(e){this._fetchAbort(),this._initPublishCount(),this._cometSwitch(!1),e(this.state.publishCount,this._cometSwitch)}},{key:"componentDidMount",value:function(){this._fetchPublishCount("&t=5000")}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.xhr,n=e.turnon,i=e.publishCount;null===t&&!0===n&&i<20&&this._fetchPublishCount()}},{key:"componentWillUnmount",value:function(){this._fetchAbort()}},{key:"render",value:function(){return a.a.createElement(wt,null,0===this.state.publishCount?a.a.createElement("div",null,"\u6ca1\u6709\u65b0\u7684\u63a8\u9001"):a.a.createElement("div",{onClick:this._handleGetNewPublish},"\u6709","".concat(this.state.publishCount),"\u6761\u65b0\u7684\u63a8\u9001"))}}]),t}(i.Component),_t=Object(b.c)(function(e){return{homeTimeline:e.blog.homeTimeline}})(yt),Ot=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e)))._handleGetNewPublish=n.props.handleGetNewPublish.bind(null,n.props.handleGetHomePosts),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.homeTimeline.timeline;if(0===e.length)this.props.handleGetHomePosts();else{var t=this.props.posts,n=e[0],i=e[e.length-1];this.props.initLastFetch(t.entities[n].created_at,t.entities[i].created_at)}}},{key:"render",value:function(){var e=this.props.homeTimeline,t=e.timeline,n=e.loading,i=e.isLoadingDirection;return a.a.createElement("div",{className:"Home"},a.a.createElement(_t,{handleGetNewPublish:this._handleGetNewPublish}),a.a.createElement(Ze,{isLoadingDirection:i,loading:n,handleGetRequest:this.props.handleGetHomePosts,itemHeight:250,timeline:t,posts:this.props.posts}))}}]),t}(i.Component),Tt=Object(b.c)(function(e){return{homeTimeline:e.blog.homeTimeline,posts:e.blog.entities.posts}},function(e){return{handleGetHomePosts:function(){return e(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return function(n,i){var a,r=i().blog;if(e?a=r.homeTimeline.lastFetch[e]:(e="bottom",a=Date.now(),n(D(a))),!a)return null;var o=N+"/home?d=".concat(e[0],"&l=").concat(a,"&n=").concat(t),l=r.homeTimeline.unreadCount,c=r.entities.posts.fetchStatus;return n(F(e)),Object(U.a)("GET",o).then(function(t){0!==t.data.length&&q(n,A(t,c,l,e,R))}).catch(function(e){n(I(e))})}}.apply(void 0,arguments))},handleGetNewPublish:function(){return e(function(e,t,n){return function(){return e("top",t).finally(function(){n(!0)})}}.apply(void 0,arguments))},initLastFetch:function(){return e(B.apply(void 0,arguments))}}})(Ot),St=n(58),jt=function(e){var t=e.component,n=e.condition,i=Object(St.a)(e,["component","condition"]);return a.a.createElement(E.a,Object.assign({},i,{render:function(e){return n?a.a.createElement(t,e):a.a.createElement(w.a,{to:{pathname:"/accessdenied",state:{from:e.location}}})}}))};function xt(){var e=Object(f.a)(["\n  text-align: center;\n  margin-top: 200px;\n  font-size: 1.5rem;\n  &>a {\n    font-weight: bold;\n    color: ",";\n    text-decoration: underline; \n  }\n"]);return xt=function(){return e},e}var Ct=C.b.div(xt(),function(e){return e.theme.color}),Ut=function(e){return a.a.createElement(Ct,null,a.a.createElement("span",null,"404, not found... ... "),a.a.createElement(v.a,{to:"/home"},"\u8fd4\u56de\u9996\u9875"))};function kt(){var e=Object(f.a)(["\n  position: relative;\n  &>div {\n      display: block;\n      border: 3px solid rgba(66,66,66,0.5);\n      background-color: transparent;\n      width: 2.5rem;\n      height: 2.5rem;\n      box-sizing: border-box;\n      border-radius: 50%;\n      position: fixed;\n      top: 4rem;\n      right: 1rem;\n      outline: none;\n      user-select: none;\n    }\n      &>div::before {\n        content: '';\n        display: block;\n        height: 1rem;\n        width: 0;\n        background-color: transparent;\n        border-top: 1rem solid  transparent;\n        border-left: .6rem solid transparent;\n        border-right: .6rem solid transparent;\n        border-bottom: 1rem solid  rgba(66,66,66,0.5);\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -100%);\n      }\n      &>div::after {\n        content: '';\n        display: block;\n        width: .4rem;\n        height: 1rem;\n        background-color: rgba(66,66,66,0.5);\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translateX(-50%);\n      }\n"]);return kt=function(){return e},e}function Nt(){var e=Object(f.a)(["\n  flex: 1 1;\n  background-color: #fff;\n  position: relative;\n  flex-shrink: 0;\n  margin-left: .5rem;\n  margin-bottom: 0;\n  width: 100%;\n  min-height: calc(100vh - 3rem);\n  @media (max-width: 1000px) {\n    margin-left: 0;\n  }\n"]);return Nt=function(){return e},e}function Dt(){var e=Object(f.a)(["\n  background-color: #fff;\n  min-width: 7.5rem;\n  max-width: 7.5rem;\n\n  &>div:nth-of-type(1) {\n    min-height: 6.25rem;\n    margin: 0 auto;\n    text-align: center;\n    border-bottom: 1px solid #ccc;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end;\n  }\n\n  &>div:nth-of-type(1)>a {\n    display: flex;\n    flex-direction: column;\n  }\n\n  &>div:nth-of-type(1)>a>img {\n    width: 4rem;\n    height: 4rem;\n    background-color: transparent;\n    margin: .25rem auto;\n    border-radius: 50%;\n  }\n\n  &>div:nth-of-type(2) {\n    text-align: right;\n    padding: .5rem .25rem;\n  }\n\n  &>div:nth-of-type(2) li {\n    margin: .5rem 0 ;\n  }\n\n  @media (max-width: 1000px) {\n    border-bottom: 1px solid #ccc;\n    max-width: 100%;\n    min-width: 100%;\n    &>div:nth-of-type(1) {\n      display: none;\n    }\n    &>div:nth-of-type(2) {\n      flex-direction: row;\n      text-align: right;\n    }\n    &>div:nth-of-type(2) ul {\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n    }\n    &>div:nth-of-type(2) ul>li {\n      margin: 0 2rem;\n    }\n  }\n"]);return Dt=function(){return e},e}function Ft(){var e=Object(f.a)(["\n  display: relative;\n  width: 1200px;\n  margin: 0 auto;\n    &>.container {\n      display: flex;\n      align-items: flex-start;\n      padding: 0 .8rem;\n    }\n\n  @media (max-width: 1000px) {\n    width: 920px;\n      &>.container {\n        flex-direction: column;\n      }\n  }\n\n"]);return Ft=function(){return e},e}function It(){var e=Object(f.a)(["\n  border-bottom: .1rem solid #ccc;\n  margin-bottom: .4rem;\n  background-color: #fff;\n  &>.header-inner {\n    min-height: 2.5rem;\n    max-height: 2.5rem;\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: .5rem 1.5rem;\n    box-sizing: border-box;\n    display: flex;\n    align-items: baseline;\n    justify-content: space-between;\n  }\n\n  &>.header-inner>a>h1 {\n    font-size: 1.5rem;\n    line-height: 1.75rem;\n  }\n\n  &>.header-inner>nav>ul {\n    display: flex;\n    flex-wrap: nowrap;\n  }\n  &>.header-inner>nav>ul>li {\n    margin: 0 .5rem;\n  }\n\n  &>.header-inner>nav>ul>li:nth-of-type(3)>a>img {\n    width: 1.25rem;\n    height: 1.25rem;\n    border-radius: 50%;\n  }\n"]);return It=function(){return e},e}var Rt=S()({loader:function(){return Promise.all([n.e(5),n.e(1)]).then(n.bind(null,316))},loading:function(){return a.a.createElement(Ye,{visible:!0})}}),At=S()({loader:function(){return n.e(2).then(n.bind(null,314))},loading:function(){return a.a.createElement(Ye,{visible:!0})}}),Lt=S()({loader:function(){return n.e(3).then(n.bind(null,315))},loading:function(){return a.a.createElement(Ye,{visible:!0})}}),Pt=C.b.header(It()),Gt=C.b.main(Ft()),Ht=C.b.aside(Dt()),Mt=C.b.section(Nt()),qt=C.b.div(kt()),zt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={visibleBackTop:!1},n._handleScroll=x()(n._handleScroll.bind(Object(m.a)(Object(m.a)(n))),167),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_handleBackTop",value:function(){document.documentElement.scrollTop=0}},{key:"_handleScroll",value:function(){var e=this.state.visibleBackTop;document.documentElement.clientHeight>=document.documentElement.scrollTop&&e?e=!1:document.documentElement.clientHeight<document.documentElement.scrollTop&&!e&&(e=!0),this.setState({visibleBackTop:e})}},{key:"componentDidMount",value:function(){document.addEventListener("scroll",this._handleScroll),window.addEventListener("beforeunload",this.props.handleSaveState)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("scroll",this._handleScroll),window.removeEventListener("beforeunload",this.props.handleSaveState)}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.username,i=e.avatar,r=e.handleSignout,o=t?"/user/".concat(t):"/",l=n||"Unknown",c=i||"unknown";return a.a.createElement(qt,null,a.a.createElement(Pt,{role:"banner"},a.a.createElement("div",{className:"header-inner"},a.a.createElement(v.a,{to:"/home"},a.a.createElement("h1",null,"Cheng\u7684\u5c0f\u7ad9")),a.a.createElement("nav",null,a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(v.a,{to:"/home"},"\u9996\u9875")),""===t?a.a.createElement("li",null,a.a.createElement(v.a,{to:"/authentication"},"\u767b\u5f55")):a.a.createElement("li",null,a.a.createElement(v.a,{to:"/home",onClick:r},"\u767b\u51fa")),a.a.createElement("li",null,a.a.createElement(v.a,{to:o,className:"dropdown-menu"},a.a.createElement("img",{alt:"",src:"".concat(O,"/").concat(c)}))))))),a.a.createElement(Gt,{role:"main"},a.a.createElement("div",{className:"container"},a.a.createElement(Ht,null,a.a.createElement("div",null,a.a.createElement(v.a,{to:o},a.a.createElement("div",null,l),a.a.createElement("img",{alt:"",src:"".concat(O,"/").concat(c)}))),a.a.createElement("div",null,a.a.createElement("nav",null,a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(v.a,{to:"/pixelpainter"},"\u50cf\u7d20\u753b\u677f")),a.a.createElement("li",null,a.a.createElement(v.a,{to:"/masonry"},"\u76f8\u518c")),a.a.createElement("li",null,a.a.createElement(v.a,{to:"/cube"},"\u9b54\u65b9")))))),a.a.createElement(Mt,null,a.a.createElement(g.a,null,a.a.createElement(E.a,{exact:!0,path:"/",render:function(){return a.a.createElement(w.a,{to:"/home"})}}),a.a.createElement(E.a,{path:"/pixelpainter",component:Rt}),a.a.createElement(E.a,{path:"/masonry",component:Lt}),a.a.createElement(E.a,{path:"/cube",component:At}),a.a.createElement(E.a,{path:"/authentication",component:we}),a.a.createElement(E.a,{path:"/accessdenied",component:Oe}),a.a.createElement(jt,{path:"/user/:user_id",condition:t,component:Ke}),a.a.createElement(jt,{path:"/post/:post_id",condition:t,component:gt}),a.a.createElement(E.a,{path:"/home",component:Tt}),a.a.createElement(E.a,{render:Ut}))))),a.a.createElement("div",{style:{display:"".concat(this.state.visibleBackTop?"block":"none")},onClick:this._handleBackTop}))}}]),t}(i.Component),Qt=Object(y.a)(Object(b.c)(function(e){return Object(c.a)({},e.blog.user)},function(e){return{handleSignout:function(){return e(function(e,t){return e({type:"SIGNOUT"}),Object(U.a)("GET",N+"/signout").then(function(e){var t=e.data;return console.log(t.message)},function(e){return console.log(e)})})},handleSaveState:function(){return e({type:"SAVE_STATE"})}}})(zt)),Vt=function(e){var t=e.history;return a.a.createElement(l.a,{history:t},a.a.createElement(Qt,null))},Bt=n(37),Wt=n(36),Jt=n(121),Xt=n(25),Yt=[{url:"//p3.pstatp.com/weili/l/189510595871244394.webp",width:572,height:429},{url:"//p1.pstatp.com/weili/l/189471047812382941.webp",width:687,height:429},{url:"//p3a.pstatp.com/weili/l/197699706935312399.webp",width:561,height:429},{url:"//p1.pstatp.com/weili/l/199469482569367578.webp",width:788,height:344},{url:"//p9.pstatp.com/weili/l/189482498195194400.webp",width:516,height:344},{url:"//p1.pstatp.com/weili/l/197714524572483585.webp",width:517,height:344},{url:"//p3.pstatp.com/weili/l/189537800194097631.webp",width:461,height:615},{url:"//p9.pstatp.com/weili/l/198355711650168848.webp",width:950,height:615},{url:"//p3.pstatp.com/weili/l/200729832132444169.webp",width:409,height:615},{url:"//p9.pstatp.com/weili/l/189476992047120459.webp",width:546,height:409},{url:"//p3.pstatp.com/weili/l/189489516171755872.webp",width:612,height:409},{url:"//p3.pstatp.com/weili/l/189532783672295532.webp",width:662,height:409},{url:"//p9.pstatp.com/weili/l/200676926725292040.webp",width:576,height:576},{url:"//p3a.pstatp.com/weili/l/189469956890689895.webp",width:860,height:576},{url:"//p1.pstatp.com/weili/l/197571914478387227.webp",width:384,height:576},{url:"//p9.pstatp.com/weili/l/189473057857077569.webp",width:963,height:302},{url:"//p3.pstatp.com/weili/l/200721001679683634.webp",width:403,height:302},{url:"//p3.pstatp.com/weili/l/197737545597190225.webp",width:455,height:302},{url:"//p3a.pstatp.com/weili/l/197805345950924870.webp",width:655,height:436},{url:"//p3a.pstatp.com/weili/l/189501499130511797.webp",width:583,height:436},{url:"//p3.pstatp.com/weili/l/189504067520954563.webp",width:583,height:436},{url:"//p3.pstatp.com/weili/l/189518661819826535.webp",width:560,height:420},{url:"//p9.pstatp.com/weili/l/197709559590289455.webp",width:631,height:420},{url:"//p3.pstatp.com/weili/l/197632190049419276.webp",width:630,height:420},{url:"//p3.pstatp.com/weili/l/189481475992977445.webp",width:713,height:401},{url:"//p3.pstatp.com/weili/l/198359697379819520.webp",width:535,height:401},{url:"//p3a.pstatp.com/weili/l/198338660630003791.webp",width:573,height:401},{url:"//p1.pstatp.com/weili/l/200255581843619840.webp",width:632,height:418},{url:"//p1.pstatp.com/weili/l/199085641342124089.webp",width:630,height:418},{url:"//p3.pstatp.com/weili/l/198502066955747502.webp",width:559,height:418},{url:"//p3a.pstatp.com/weili/l/189479225430114995.webp",width:620,height:413},{url:"//p3a.pstatp.com/weili/l/198578903920672826.webp",width:578,height:413},{url:"//p9.pstatp.com/weili/l/189487360098173271.webp",width:622,height:413},{url:"//p3.pstatp.com/weili/l/189489919898681548.webp",width:415,height:311},{url:"//p9.pstatp.com/weili/l/200407314448252932.webp",width:415,height:311},{url:"//p1.pstatp.com/weili/l/189473092216815738.webp",width:990,height:311},{url:"//p3.pstatp.com/weili/l/200036985188122632.webp",width:364,height:485},{url:"//p9.pstatp.com/weili/l/189484534009692595.webp",width:728,height:485},{url:"//p9.pstatp.com/weili/l/197961218904031240.webp",width:729,height:485},{url:"//p1.pstatp.com/weili/l/200749649111547933.webp",width:466,height:625},{url:"//p3.pstatp.com/weili/l/200339788972425228.webp",width:938,height:625},{url:"//p3.pstatp.com/weili/l/185735293848259534.webp",width:416,height:625},{url:"//p1.pstatp.com/weili/l/189492660087816938.webp",width:649,height:406},{url:"//p3a.pstatp.com/weili/l/189518971057471657.webp",width:562,height:406},{url:"//p3.pstatp.com/weili/l/199916708923965454.webp",width:610,height:406},{url:"//p1.pstatp.com/weili/l/200885404437839888.webp",width:477,height:476},{url:"//p1.pstatp.com/weili/l/189466572456460337.webp",width:636,height:476},{url:"//p1.pstatp.com/weili/l/189496379529494767.webp",width:846,height:476},{url:"//p1.pstatp.com/weili/l/185734838581732262.webp",width:317,height:476},{url:"//p3a.pstatp.com/weili/l/189482867562381394.webp",width:658,height:476},{url:"//p3.pstatp.com/weili/l/189475179570921915.webp",width:631,height:396},{url:"//p3a.pstatp.com/weili/l/189533831644316302.webp",width:595,height:396},{url:"//p3a.pstatp.com/weili/l/198366620867100706.webp",width:595,height:396},{url:"//p3.pstatp.com/weili/l/189482412295848187.webp",width:745,height:496},{url:"//p3.pstatp.com/weili/l/189523412053656134.webp",width:744,height:496},{url:"//p3.pstatp.com/weili/l/189474200318378193.webp",width:332,height:496},{url:"//p9.pstatp.com/weili/l/189487162529677315.webp",width:455,height:455},{url:"//p9.pstatp.com/weili/l/189470437927026706.webp",width:683,height:455},{url:"//p3a.pstatp.com/weili/l/198520260437213193.webp",width:683,height:455},{url:"//p1.pstatp.com/weili/l/189496336579821721.webp",width:847,height:423},{url:"//p3a.pstatp.com/weili/l/189502392483709566.webp",width:674,height:423},{url:"//p9.pstatp.com/weili/l/198465765892161538.webp",width:300,height:423},{url:"//p9.pstatp.com/weili/l/189521659706999448.webp",width:648,height:405},{url:"//p3.pstatp.com/weili/l/197917332928200782.webp",width:542,height:405},{url:"//p1.pstatp.com/weili/l/189477318464635178.webp",width:630.9999389648438,height:405},{url:"//p3.pstatp.com/weili/l/189510295223533740.webp",width:701,height:394},{url:"//p3a.pstatp.com/weili/l/189491045180113379.webp",width:593,height:394},{url:"//p3a.pstatp.com/weili/l/189463445720269344.webp",width:527,height:394},{url:"//p1.pstatp.com/weili/l/197652384985645082.webp",width:468,height:624},{url:"//p3a.pstatp.com/weili/l/189484336441196690.webp",width:415,height:624},{url:"//p1.pstatp.com/weili/l/189531770060014053.webp",width:937,height:624},{url:"//p3a.pstatp.com/weili/l/200160645886509061.webp",width:364,height:485},{url:"//p9.pstatp.com/weili/l/199948045005357064.webp",width:728,height:485},{url:"//p3a.pstatp.com/weili/l/189487360098172993.webp",width:729,height:485}],Zt=function(e,t){if(!e)return{cache:Yt,display:[],loading:!1};switch(t.type){case"GET_IMAGE_SRC":case"FETCH_POSTS_REQUEST":return{cache:e.cache.slice(30),display:[].concat(Object(Xt.a)(e.display),Object(Xt.a)(e.cache.slice(0,30))),loading:!0};case"FETCH_POSTS_SUCCESS":return{cache:[].concat(Object(Xt.a)(e.cache),Object(Xt.a)(t.data.slice(45))),display:e.display,loading:!1};default:return e}},$t=n(4),Kt={FRONT:"red",BEHIND:"orange",LEFT:"blue",RIGHT:"green",UP:"yellow",DOWN:"white"},en=function(e,t,n){var i={FRONTX:[-1,0,1,-1,0,1,-1,0,1],FRONTY:[-1,-1,-1,0,0,0,1,1,1],FRONTZ:1.5,FRONTRotate3d:[0,0,0,0],BEHINDX:[1,0,-1,1,0,-1,1,0,-1],BEHINDY:[-1,-1,-1,0,0,0,1,1,1],BEHINDZ:-1.5,BEHINDRotate3d:[0,1,0,180],LEFTX:-1.5,LEFTY:[-1,-1,-1,0,0,0,1,1,1],LEFTZ:[-1,0,1,-1,0,1,-1,0,1],LEFTRotate3d:[0,1,0,-90],RIGHTX:1.5,RIGHTY:[-1,-1,-1,0,0,0,1,1,1],RIGHTZ:[1,0,-1,1,0,-1,1,0,-1],RIGHTRotate3d:[0,1,0,90],UPX:[-1,0,1,-1,0,1,-1,0,1],UPY:-1.5,UPZ:[-1,-1,-1,0,0,0,1,1,1],UPRotate3d:[1,0,0,90],DOWNX:[-1,0,1,-1,0,1,-1,0,1],DOWNY:1.5,DOWNZ:[1,1,1,0,0,0,-1,-1,-1],DOWNRotate3d:[1,0,0,-90]},a=[[0,0],[-1,0],[-2,0],[0,-1],[-1,-1],[-2,-1],[0,-2],[-1,-2],[-2,-2]];return new Array(9).fill(0).map(function(t,r){var o,l=i["".concat(e,"X")],c=i["".concat(e,"Y")],u=i["".concat(e,"Z")],s=[Array.isArray(l)?l[r]:l,Array.isArray(c)?c[r]:c,Array.isArray(u)?u[r]:u],d=i["".concat(e,"Rotate3d")];switch(n){case"red":o={x:a[r][0]-0,y:a[r][1]-0};break;case"orange":o={x:a[r][0]-0,y:a[r][1]-3};break;case"blue":o={x:a[r][0]-3,y:a[r][1]-3};break;case"green":o={x:a[r][0]-3,y:a[r][1]-0};break;case"yellow":o={x:a[r][0]-6,y:a[r][1]-0};break;case"white":o={x:a[r][0]-6,y:a[r][1]-3}}return{position:{action:[0,0,0],translate3d:s,rotate3d:d},aspect:{id:r,color:n,backgroundPos:o}}})},tn=function(e){for(var t=[],n=Object.entries(e),i=0;i<n.length;i++){var a=n[i],r=Object(lt.a)(a,2),o=r[0],l=r[1];t.push.apply(t,Object(Xt.a)(en(o,0,l)))}return t},nn=tn(Kt),an=nn.map(function(e){return e.aspect.color}),rn={size:50,cubes:nn,globalDisplay:an,view:"FRONT",colors:Kt,rotating:!1,records:[],inputFieldValue:"",submitting:!1,submitStatus:"\u8bf7\u8f93\u5165\u64cd\u4f5c\u4f8b\u5982\uff1aU D' F2 RY\u3002"},on=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESTORE":return Object($t.a)(e,function(e){var t=tn(Kt);e.cubes=t,e.globalDisplay=t.map(function(e){return e.aspect.color}),e.records=[]});case"VIEW_CHANGING":return Object($t.a)(e,function(e){e.view=t.view,e.rotating=!0});case"VIEW_CHANGED":return Object($t.a)(e,function(e){e.rotating=!1});case"CUBE_ROTATING":return Object($t.a)(e,function(e){e.cubes=t.cubes,e.rotating=!0});case"CUBE_ROTATED":return Object($t.a)(e,function(e){e.cubes=t.cubes,e.rotating=!1});case"INPUT_CHANGE":return Object($t.a)(e,function(e){e.inputFieldValue=t.value});case"INPUT_SUBMITTING":return Object($t.a)(e,function(e){e.inputFieldValue&&e.records.unshift(e.inputFieldValue),e.submitting=!0,e.submitStatus="\u64cd\u4f5c\u9b54\u65b9\u4e2d......"});case"INPUT_SUBMITTED":return Object($t.a)(e,function(e){e.inputFieldValue="",e.submitting=!1,e.submitStatus="\u8bf7\u8f93\u5165\u65cb\u8f6c\u64cd\u4f5c\u3002",e.globalDisplay=e.cubes.map(function(e){return e.aspect.color})});case"SUBMIT_FAILED":return Object($t.a)(e,function(e){e.inputFieldValue="",e.submitStatus="\u8f93\u5165\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002"});default:return e}},ln={homeTimeline:{timeline:[],cursor:{bottom:null,top:null},loading:!1,lastFetch:{bottom:null,top:null},isLoadingDirection:"none",atEnd:!1,unreadCount:0},entities:{posts:{entities:{},fetchStatus:{}},comments:{entities:{},fetchStatus:{}},users:{entities:{},fetchStatus:{}}},user:{username:"",id:"",avatar:""},authentication:{status:"",message:"",fields:{username:{required:!0,type:"text",name:"username",prefix:"",suffix:"",value:"",help:"\u8d26\u53f7\u9700\u7531\u957f\u5ea6\u4e3a6\u81f316\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57\u7ec4\u6210\uff0c\u9996\u5b57\u7b26\u987b\u4e3a\u5b57\u6bcd\u3002",error:"",validate:!1,validator:{pattern:"^[a-zA-Z][a-zA-Z0-9]{5,15}$",message:"\u8f93\u5165\u6709\u8bef\u3002"}},password:{required:!0,type:"password",name:"password",prefix:"",suffix:"",value:"",help:"\u5bc6\u7801\u9700\u7531\u957f\u5ea6\u4e3a6\u81f318\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57\u7ec4\u6210\u3002",error:"",validate:!1,validator:{pattern:"^[a-zA-Z0-9]{6,18}$",message:"\u8f93\u5165\u6709\u8bef\u3002"}},avatar:{required:!1,type:"file",name:"avatar",prefix:"",suffix:"",value:"",accept:"image/png, image/jpeg, image/gif, image/jpg, image/svg+xml",help:"\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u3002",error:"",validate:!1,validator:{pattern:"^image\\/(png|jpeg|gif|jpg|svg\\+xml)$",message:"\u4e0a\u4f20\u7c7b\u578b\u6709\u8bef\u3002"}},captcha:{required:!0,type:"text",name:"captcha",prefix:"",suffix:"/api/captcha",value:"",help:"\u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u6ce8\u610f\u5927\u5c0f\u5199\u3002",error:"",validate:!1,validator:{pattern:"^\\S+$",message:"\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a\u3002"}}}},postEditor:{status:"",message:"",fields:{title:{required:!0,type:"text",name:"title",prefix:"",suffix:"",value:"",help:"",error:"",validate:!1,validator:{pattern:"^[\\S\\s]{6,}$",message:"\u6807\u9898\u4e0d\u53ef\u5c11\u4e8e6\u4e2a\u5b57\u3002"}},content:{required:!0,type:"draft",name:"content",prefix:"",suffix:"",value:Se.a.createEditorState(null),controls:["bold","italic","underline","text-color","separator","link","media","emoji","blockquote","code","clear","undo","redo"],help:"",error:"",validate:!1,validator:{pattern:'(?<=,"text":)(.)*?(?=,"type":"unstyled")',minLength:8,message:"\u5185\u5bb9\u4e0d\u53ef\u5c11\u4e8e8\u4e2a\u5b57,\u4e0a\u4f20\u56fe\u7247\u4e0d\u8981\u5927\u4e8e50kb\u3002"}}}},commentEditor:{status:"",message:"",fields:{content:{required:!0,type:"draft",name:"content",prefix:"",suffix:"",value:Se.a.createEditorState(null),controls:["italic","underline","text-color","emoji","clear"],help:"",error:"",validate:!1,validator:{pattern:'(?<=,"text":)(.)*?(?=,"type":"unstyled")',minLength:8,maxLength:150,maxLine:6,message:"\u8bc4\u8bba\u5b57\u6570\u4e0d\u591f\u6216\u8005\u7bc7\u5e45\u8fc7\u957f(\u987b150\u4e2a\u5b57\u4ee5\u5185)\u3002"}}}}},cn=function(e,t){if(!e){var n=localStorage.getItem("data");if(console.log(n),n){var i=JSON.parse(n),a=i.homeTimeline,r=i.entities,o=i.user,l=i.timestamp;if(Date.now()-l<864e5)return Object(c.a)({},ln,{homeTimeline:a,entities:r,user:o})}return ln}switch(t.type){case"INIT_LAST_FETCH":return Object($t.a)(e,function(e){e.homeTimeline.lastFetch=t.payload});case"FIRST_GET_REQUEST":return Object($t.a)(e,function(e){e.homeTimeline.lastFetch.top=t.payload.lastFetch});case"GET_REQUEST":return Object($t.a)(e,function(e){e.homeTimeline.loading=!0,e.homeTimeline.isLoadingDirection=t.payload.direction});case"GET_TIMELINE_STATE":return Object($t.a)(e,function(e){var n=t.payload,i=n.unreadCount,a=n.direction,r=n.lastFetch;e.homeTimeline.loading=!1,e.homeTimeline.isLoadingDirection="none",e.homeTimeline.unreadCount=i,e.homeTimeline.lastFetch[a]=r});case"GET_HOME_POSTS_SUCCESS":return Object($t.a)(e,function(e){var n,i=t.payload,a=i.method,r=i.ids,o=i.data;(n=e.homeTimeline.timeline)[a].apply(n,Object(Xt.a)(r)),o.forEach(function(t){e.entities.posts.entities[t.id]=Object(c.a)({},t,{timeline:[]}),e.entities.posts.fetchStatus[t.id]="loaded"})});case"GET_USER_POSTS_SUCCESS":return Object($t.a)(e,function(e){var n,i=t.payload,a=i.user_id,r=i.method,o=i.ids,l=i.data;(n=e.entities.users.entities[a].timeline)[r].apply(n,Object(Xt.a)(o)),l.forEach(function(t){e.entities.posts.entities[t.id]=Object(c.a)({},t,{timeline:[]}),e.entities.posts.fetchStatus[t.id]="loaded"})});case"GET_POSTS_WITH_ENTITY_SUCCESS":return Object($t.a)(e,function(e){var n=t.payload,i=n.user_id,a=n.ids,r=n.data,o=n.entity;e.entities.users.entities[i]=Object(c.a)({},o,{user_id:i,timeline:a}),e.entities.users.fetchStatus[i]="loaded",r.forEach(function(t){e.entities.posts.entities[t.id]=Object(c.a)({},t,{timeline:[]}),e.entities.posts.fetchStatus[t.id]="loaded"})});case"GET_COMMENTS_SUCCESS":return Object($t.a)(e,function(e){var n,i=t.payload,a=i.post_id,r=i.ids,o=i.method,l=i.data;(n=e.entities.posts.entities[a].timeline)[o].apply(n,Object(Xt.a)(r)),l.forEach(function(t){e.entities.comments.entities[t.id]=Object(c.a)({},t,{timeline:[]}),e.entities.comments.fetchStatus[t.id]="loaded"})});case"GET_REQUEST_FAILURE":return Object($t.a)(e,function(e){e.homeTimeline.loading=!1,e.homeTimeline.isLoadingDirection="none",console.log(t.payload.error)});case"DELETE_REQUEST":case"UPDATE_REQUEST":return Object($t.a)(e,function(e){e.homeTimeline.loading=!0});case"DELETE_REQUEST_SUCCESS":return Object($t.a)(e,function(e){var n=t.payload,i=n.post_id,a=n.id;e.homeTimeline.loading=!1,e.entities.posts.entities[i].timeline=e.entities.posts.entities[i].timeline.filter(function(e){return a!==e}),delete e.entities.comments.entities[a],delete e.entities.comments.fetchStatus[a]});case"UPDATE_COMMENT_REQUEST_SUCCESS":return Object($t.a)(e,function(e){Object.entries(t.payload.entity).forEach(function(n){var i=Object(lt.a)(n,2),a=i[0],r=i[1];e.entities.comments.entities[t.payload.id][a]=r})});case"UPDATE_POST_REQUEST_SUCCESS":return Object($t.a)(e,function(e){Object.entries(t.payload.entity).forEach(function(n){var i=Object(lt.a)(n,2),a=i[0],r=i[1];e.entities.posts.entities[t.payload.id][a]=r})});case"DELETE_REQUEST_FAILURE":return Object($t.a)(e,function(e){var n=t.payload.message;e.homeTimeline.loading=!1,console.log(n)});case"UPDATE_REQUEST_FAILURE":return Object($t.a)(e,function(e){var n=t.payload,i=n.message,a=n.inputField;e.homeTimeline.loading=!1,e[a].message=i,console.log(i)});case"ADD_REQUEST":return Object($t.a)(e,function(e){e.homeTimeline.loading=!0,e.homeTimeline.isLoadingDirection="top"});case"ADD_TIMELINE_STATE":return Object($t.a)(e,function(e){e.homeTimeline.loading=!0,e.homeTimeline.isLoadingDirection="none",e.homeTimeline.lastFetch[t.payload.direction]=t.payload.lastFetch});case"ADD_POST_SUCCESS":return Object($t.a)(e,function(e){var n=t.payload,i=n.user_id,a=n.id,r=n.entity;e.entities.users.entities[i].timeline.unshift(a),e.entities.posts.entities[a]=Object(c.a)({},r,{timeline:[]}),e.entities.posts.fetchStatus[a]="loaded"});case"ADD_COMMENT_SUCCESS":return Object($t.a)(e,function(e){var n=t.payload,i=n.post_id,a=n.id,r=n.entity;e.entities.posts.entities[i].timeline.push(a),e.entities.comments.entities[a]=Object(c.a)({},r,{timeline:[]}),e.entities.comments.fetchStatus[a]="loaded"});case"ADD_REQUEST_FAILURE":return Object($t.a)(e,function(e){var n=t.payload,i=n.message,a=n.inputField;e.homeTimeline.loading=!1,e.homeTimeline.isLoadingDirection="none",e[a].message=i});case"AUTHENTICATION":return Object($t.a)(e,function(e){e.homeTimeline.loading=!0});case"AUTHENTICATION_SUCCESS":return Object($t.a)(e,function(e){var n=t.payload,i=n.username,a=n.id,r=n.avatar;e.homeTimeline.loading=!1,e.user.username=i,e.user.id=a,e.user.avatar=r,e.entities.users.entities[a]={username:i,id:a,avatar:r,timeline:[]},e.entities.users.fetchStatus[a]="loaded"});case"AUTHENTICATION_FAILURE":return Object($t.a)(e,function(e){var n=t.payload,i=n.message,a=n.inputField;e.homeTimeline.loading=!1,e[a].message=i});case"INPUTFIELD_CHANGE":return Object($t.a)(e,function(e){var n=t.inputField,i=t.field,a=t.data;Object.entries(a).forEach(function(t){var a=Object(lt.a)(t,2),r=a[0],o=a[1];e[n].fields[i][r]=o})});case"INPUTFIELD_INIT":return Object($t.a)(e,function(n){var i=t.payload,a=i.inputField,r=i.message,o=e[a].fields;r&&(n[a].message=""),Object.keys(o).forEach(function(e){n[a].fields[e].value="draft"!==o[e].type?"":Se.a.createEditorState(null),n[a].fields[e].error="",n[a].fields[e].prefix="",n[a].fields[e].suffix="",n[a].fields[e].validate=!1})});case"TRANSMIT_VALUES":return Object($t.a)(e,function(e){var n=t.payload,i=n.inputField,a=n.entries;Object.entries(a).forEach(function(t){var n=Object(lt.a)(t,2),a=n[0],r=n[1];e[i].fields[a].value="content"!==a?r:Se.a.createEditorState(r),e[i].fields[a].validate="content"!==a})});case"SIGNOUT":return localStorage.removeItem("data"),Object($t.a)(e,function(e){e.user.username="",e.user.id="",e.user.avatar=""});case"SAVE_STATE":var u=e.homeTimeline,s=e.entities,d=e.user;return localStorage.setItem("data",JSON.stringify({homeTimeline:u,entities:s,user:d,timestamp:Date.now()})),e;case"TIMELINESTATE_INIT":return Object($t.a)(e,function(e){e.homeTimeline.cursor.bottom=null,e.homeTimeline.cursor.top=null,e.homeTimeline.loading=!1,e.homeTimeline.lastFetch.bottom=null,e.homeTimeline.lastFetch.top=null,e.homeTimeline.isLoadingDirection="none",e.homeTimeline.atEnd=!1,e.homeTimeline.unreadCount=0});case"XHR_ABORT":return Object($t.a)(e,function(e){});default:return e}},un=function(e){return Object(Wt.c)({cube:on,masonry:Zt,blog:cn,router:Object(l.b)(e)})},sn=n(127),dn=Object(Bt.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pn=function(e){var t=Wt.d;return Object(Wt.e)(un(dn),e,t(Object(Wt.a)(Object(Jt.a)(dn),sn.a)))}();o.a.render(a.a.createElement(C.a,{theme:{color:"royalblue",bgc:"#E8F5FD"}},a.a.createElement(b.a,{store:pn},a.a.createElement(Vt,{history:dn}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},29:function(e,t,n){"use strict";var i=n(28);t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(a,r){var o=new XMLHttpRequest,l=n.body,c=void 0===l?null:l,u=n.headers,s=n.timeout,d=void 0===s?12e3:s;o.open(e,t),u&&"object"===typeof u&&Object.entries(u).forEach(function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return o.setRequestHeader(n,a)}),o.timeout=d,o.send(c),o.onload=function(){if(o.status<400)try{a(JSON.parse(o.responseText))}catch(e){a(o.responseText)}else{console.log(o.statusText);try{r(JSON.parse(o.responseText))}catch(e){r(o.responseText)}}},o.onerror=function(){r(o.statusText)},o.ontimeout=function(){r("Timeout!")}})}},54:function(e,t,n){"use strict";var i=n(3),a=n(0),r=n.n(a);function o(){var e=Object(i.a)(["\n    width: 100%;\n\n    &>input {\n      box-sizing: border-box;\n      font-size: 1rem;\n      line-height: 1.25rem;\n      width: 100%;\n      max-height: 1.25rem;\n      border-radius: .5rem;\n      text-indent: 1em;\n      outline: none;\n      border: 1px solid ",";\n    }\n\n    &>input:focus {\n      border: .1rem solid ","\n    }\n"]);return o=function(){return e},e}var l=n(2).b.div(o(),function(e){return e.theme.color},function(e){return e.theme.color});t.a=function(e){return r.a.createElement(l,null,r.a.createElement("input",{type:e.type,name:e.name,value:e.value,disabled:e.disabled,onChange:e.onChange}))}},77:function(e,t,n){"use strict";var i=n(58),a=n(11),r=n(12),o=n(15),l=n(13),c=n(14),u=n(3),s=n(0),d=n.n(s);function p(){var e=Object(u.a)(["\n  width: 100%;\n  background-color: #999c;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n\n    &>div {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      width: 850px;\n      transform: translate(-50%, -50%);\n      box-shadow: 0 1px .2rem rgba(0,0,0,0.25);\n      background: #fff;\n      border-radius: 1rem;\n    }\n    \n    &>div:hover {\n      cursor: grab;\n    }\n\n"]);return p=function(){return e},e}var h=n(2).b.div(p()),m=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"_handlePreventMouseWhell",value:function(e){e.preventDefault()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.alive?window.addEventListener("mousewheel",this._handlePreventMouseWhell):window.removeEventListener("mousewheel",this._handlePreventMouseWhell)}},{key:"render",value:function(){var e=this.props,t=e.alive,n=e.handleShutDown,a=e.outerlayer,r=Object(i.a)(e,["alive","handleShutDown","outerlayer"]),o=t?"block":"none",l=t?"all":"none",c=t?"1":"0",u=t?"999":"-1";return d.a.createElement(h,{ref:a,onClick:n,style:{display:o,pointerEvents:l,opacity:c,zIndex:u}},d.a.createElement("div",{onDrag:this._handleDrag},this.props.render(r)))}}]),t}(s.Component);t.a=m},82:function(e,t,n){"use strict";var i=n(3),a=n(0),r=n.n(a);function o(){var e=Object(i.a)(["\n  button {\n    border: none;\n    background-color: ",";\n    color: #fff;\n    border-radius: 1rem;\n    min-width: 3.75rem;\n    cursor: pointer;\n    white-space: nowrap;\n    line-height: 1.25rem;\n    padding: .25rem;\n    outline: none;\n  }\n\n  button.disabled {\n    background-color: orange;\n  }\n\n  button.disabled:hover {\n    background-color: red;\n    cursor: not-allowed;\n  }\n"]);return o=function(){return e},e}var l=n(2).b.span(o(),function(e){return e.theme.color});t.a=function(e){return r.a.createElement(l,null,r.a.createElement("button",{onClick:function(t){t.preventDefault(),e.onClick()},className:e.className},e.text))}}},[[130,6,4]]]);
//# sourceMappingURL=main.4b42edd1.chunk.js.map